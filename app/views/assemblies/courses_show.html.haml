= render 'layouts/filepicker'
- content_for :title, "#{@course.title.html_safe} - Course"
- content_for :description, @course.description != "" ? @course.description.html_safe : @course.title.html_safe
- @body_tag_attributes = {:'ng-app' => "ChefStepsApp", :'ng-controller' => "ActivityController"}

/ .container.section(ng-cloak)
/   .course-nav
/     %ul.nav.nav-tabs.nav-stacked.section
/       - @course.assembly_inclusions.each_with_index do |inclusion,index|
/         - act_id = @course.assembly_inclusions[index].includable.id
/         - next_act_id = @course.assembly_inclusions[index+1] ? @course.assembly_inclusions[index+1].includable.id : [] 
/         %li(ng-class="{active: #{act_id} == activity.id}")
/           %a(ng-click="startViewActivity(#{act_id}, #{next_act_id});")
/             #{inclusion.includable.title}

/   .row(ng-cloak)
/     .span12
/       .tab-content(ng-init="loadActivity(#{@course.assembly_inclusions[0].includable.id})")
/         = render 'activities/latest/main_activity_content', activity: @course.assembly_inclusions[0].includable

/ -# By not cloaking this, it will be on while the page is first loading before angular takes charge
/ .assembly-loading-background(ng-show="loading" ng-animate="'fade'")
/   .activity-loading-spinner
/     .span12
/       %i.icon-spinner.icon-spin

.container(ng-controller='CoursesController' ng-init="init(#{@course.id})")
  .row
    .span3
      %ul.nav.nav-tabs.nav-stacked.section(ng-cloak)
        %li(ng-repeat='inclusion in course.assembly_inclusions')
          %a(ng-click='load_inclusion(inclusion.includable_type, inclusion.includable_id)')
            {{inclusion.includable_title}}
        %li
          %a(ng-click="load_inclusion('Upload')")
            Upload Your Own

    .span9
      .container-fluid(ng-cloak)
        .row-fluid
          .span12
            %div(ng-switch on='view_inclusion')
              - @course.assembly_inclusions.each do |inclusion|
                - case inclusion.includable_type
                - when 'Activity'
                  %div(ng-switch-when="Activity_#{inclusion.includable_id}")
                    %div(ng-controller='ActivityController')
                      %div(ng-init="loadActivity(view_inclusion_id)")
                        = render 'activities/latest/main_activity_content', activity: @course.assembly_inclusions[0].includable
                - when 'Quiz'
                  %div(ng-switch-when="Quiz_#{inclusion.includable_id}")
                    = render 'activities/quiz_content', course_quiz: inclusion.includable
              %div(ng-switch-when='Upload')
                Viewing Upload

  .assembly-loading-background(ng-show="loading" ng-animate="'fade'")
    .activity-loading-spinner
      .span12
        %i.icon-spinner.icon-spin
             