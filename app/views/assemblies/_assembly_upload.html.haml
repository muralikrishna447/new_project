.flat-form(ng-controller='UploadsController' ng-init="init(#{assembly.id})" )
  .span6(ng-show="upload.status == 'new'")
    %form(ng-submit='submit()')
      %h2 Upload a Photo

      %h3 Title
      %p Name your creation
      %input.input-block-level(type='text' ng-model='upload.title' required=true)

      %h3 Story
      %p Tell us a story about your success, failures, variations and creations.  What worked and what didn't work?  What did you change to suit your palate or your dietary restrictions?
      %textarea.input-block-level(ng-model='upload.notes' required=true)

      %h3 Add a photo
      %p Click the button below to show a picture along with your creation.
      %p
        %img(ng-src="{{upload.image_src}}" ng-show='upload.image_src.length > 0')
        %input(type='hidden' ng-model='upload.image_id')
        .btn.btn-secondary(ng-click='addPhoto()')
          %span(ng-show="typeof(upload.image_id) == 'undefined'")
            Upload Photo
          %span(ng-show="typeof(upload.image_id) != 'undefined'")
            Change Photo
      %p
        %input.btn.btn-primary(type='submit')
        = link_to 'your profile.', user_profile_path(current_user)
    .modal#upload-modal
      .modal-header
        %h4= "Congratulations, you've completed the #{@course.title} Course!"
      .modal-body
        %p= "Here's your badge, which we'll display on #{link_to 'your profile.', user_profile_path(current_user)}".html_safe
        = link_to 'your profile.', user_profile_path(current_user)
      .modal-footer
        .btn.btn-primary.btn-large{data: {dismiss: 'modal', target: '#upload-modal'}}
          Done
        = link_to 'your profile.', user_profile_path(current_user)
  %div(ng-show="upload.status == 'show'")
    %h2 Upload Successful!
    %h3
      {{upload.title}}
    %p
      {{upload.notes}}
    %img(ng-src="{{upload.image_src}}")
