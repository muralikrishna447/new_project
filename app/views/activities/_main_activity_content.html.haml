.span6.section#video-ingredient-unit

  %div(collapse="! (editMode && editMeta)")
    = render 'metadata'

  .video-container{:itemscope => true, :itemprop => "video", :itemtype => "http://schema.org/VideoObject"}
    = render 'hero_visual', activity: activity

  %csEditPair.section
    %csEditPairShow
      .activity-description-wrapper(ng-show="!!activity.description")
        .activity-description#activity-description
          %div(ng-bind-html-unsafe="activity.description | markdown | shortcode")
          .activity-description-overlay(ng-hide="activity.description.length < 455")
        .text-center(ng-hide="false || editMode || (activity.description.length < 455)")
          = link_to 'more', 'javascript:void(0);', id: 'activity-description-maximize'
      %div.disabled-section(ng-show="editMode && (!activity.description)")
        Add description...
    %csEditPairEdit
      %textarea(ng-model="activity.description" rows="5" placeholder="Add description...")

  .section.csmonitorinputactivity
    .activity-ingredients-list#full-ingredients-list.section{data: {target: ''}}
      .well(ng-show="activity.ingredients.length" )
        = render 'ingredients_list'
    .nav(ng-show="editMode")
      %h4(ng-show="! activity.ingredients.length" ng-class="disableIf(!activity.ingredients.length)") Ingredients
      %button.btn.btn-small.btn-basic.add-item(ng-click="addIngredient()")
        +
      %button.btn.btn-small.btn-primary.done(ng-show="hasActiveInputs")
        Done

  .section
    %csEditPair
      %csEditPairShow
        %div(ng-show="!!activity.yield  || editMode" ng-class="disableIf(! activity.yield)")
          %h4 Yield
          %span(itemprop="recipeYield" ng-bind="activity.yield || 'Add yield info...' "){data: {:"orig-value" => "{{activity.yield}}"}}

      %csEditPairEdit
        %h4 Yield
        %input(type="text" ng-model="activity.yield" placeholder="Add yield info..." )

  .section
    %csEditPair
      %csEditPairShow
        %div(ng-show="!!activity.timing || editMode" ng-class="disableIf(! activity.timing)")
          %h4 Timing
          %span(ng-bind="activity.timing || 'Add timing info...' ")

      %csEditPairEdit
        %h4 Timing
        %input(type="text" ng-model="activity.timing" placeholder="Add timing info..." )

  .section.csmonitorinputactivity
    %h4(ng-show="hasRequiredEquipment() || editMode" ng-class="disableIf(! hasRequiredEquipment())") Equipment and Materials
    %ul.no-bullet(ui-sortable="sortOptions" ng-model="activity.equipment")
      %li.relative(ng-repeat="item in activity.equipment | filter:requiredEquipment")
        %csEquipmentEditPair(csOptional="false")
    .nav(ng-show="editMode")
      %button.btn.btn-small.btn-basic.add-item(ng-click="addEquipment(false)")
        +
      %button.btn.btn-small.btn-primary.done(ng-show="hasActiveInputs")
        Done

  .section.csmonitorinputactivity
    %h4(ng-show="hasOptionalEquipment() || editMode" ng-class="disableIf(! hasOptionalEquipment())") Optional Equipment and Materials
    %ul.no-bullet(ui-sortable="sortOptions" ng-model="activity.equipment")
      %li.relative(ng-repeat="item in activity.equipment | filter:optionalEquipment")
        %csEquipmentEditPair(csOptional="true")
    .nav(ng-show="editMode")
      %button.btn.btn-small.btn-basic.add-item(ng-click="addEquipment(true)")
        +
      %button.btn.btn-small.btn-primary.done(ng-show="hasActiveInputs")
        Done

  - if activity.used_in_activities.published.any?
    .section(ng-hide="editMode")
      %h4 Used In
      %ul.no-bullet
        - activity.used_in_activities.published.each do |activity|
          %li= link_to activity.title.html_safe, activity

  - if activity.published_variations.any?
    .section(ng-hide="editMode")
      %h4 Variations
      %ul.no-bullet
        - activity.published_variations.each do |activity|
          %li= link_to activity.title.html_safe, activity

- if activity.steps.any?
  .span6
    .section.scroll-shadow-wrapper
      .ordered-steps.scroll-shadow{:itemprop => "recipeInstructions"}
        .scroll-shadow-content.pull-left
          - step_number = 0
          - activity.steps.each_with_index do |step,index|
            .ordered-step-item{id: "order-step-item-#{index}"}
              .step-element.step-number
                - if step.hide_number?
                  - step_number
                - else
                  = step_number+=1
              .step-element.step-content
                - if step.title?
                  %h4= step.title
                - if step.ingredients.any?
                  .step-ingredients-source.well
                    = render 'old_ingredients_list', ingredients: step.ingredients
                :markdown
                  #{apply_shortcodes(step.directions)}
                .step-actions.btn-group
                  / -if step.ingredients.any?
                  /   .btn.step-action-item.step-ingredients.btn-primary
                  /     %i.icon-th-list
                  - if step.image_id?
                    .btn.step-action-item.step-image-btn.btn-primary
                      %i.icon-picture
                  - if step.youtube_id?
                    .btn.step-action-item.step-video-btn.btn-primary
                      %i.icon-facetime-video
                - if step.image_id?
                  .step-image{id: "step-image-#{index}"}
                    -descrip = filepicker_image_description(step.image_id, step.image_description)
                    = image_tag filepicker_step_image(step.image_id), alt: descrip, title: descrip, :itemprop => 'image'
                - if step.youtube_id?
                  .step-video{id: "step-video-#{index}"}
                    .video-container(csenforceaspect)
                      %iframe{src: youtube_url(step.youtube_id)}

        .scroll-overlay-top
        .scroll-overlay-bottom

