:ruby
  is_template = ingredient.nil?
  ingredients ||= Ingredient.titles
  field_name_prefix ||= "recipe[ingredients][]"

  row_id ||= 'ingredient-row' if is_template
  title_data_attrs = {
    data: {source: ingredients, provide: 'typeahead'},
    autocomplete: 'off'
  }

  unless is_template
    title = ingredient.title
    display_quantity = ingredient.display_quantity
    unit = ingredient.unit
  end

%tr{id: row_id, class: ('template-row' if is_template )}
  %td= text_field_tag "#{field_name_prefix}[title]", title, title_data_attrs
  %td= text_field_tag "#{field_name_prefix}[display_quantity]", display_quantity
  %td
    = text_field_tag "#{field_name_prefix}[unit]", unit
    = remove_button 'tr'
    = reorder_icon
