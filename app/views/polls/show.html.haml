.container#poll{data: {:'poll-id' => "#{@poll.id}"}}
  .row
    .span12(ng-controller='VotesController')
      - current_user_votes = current_user.votes.scoped_by_type('PollItem').map(&:votable_id)
      %span(ng-model="current_user_votes" ng-init="current_user_votes=#{current_user_votes}")
      %h1
        {{poll.title}}
      %h3
        {{poll.description}}
      %div(ng-repeat="poll_item in poll.poll_items | orderBy:'-votes_count'" ng-cloak)
        .poll-item
          .poll-item-vote-up
            %span(ng-switch on="current_user_voted_for_this(poll_item)")
              %span(ng-switch-when='true')
                .poll-item-btn.poll-item-btn-voted
                  %i.icon-angle-up
                  .poll-item-vote-count
                    {{poll_item.votes_count}}
              %span(ng-switch-when='false')
                .poll-item-btn(ng-click="voteObject(poll_item,$index)")
                  %i.icon-angle-up
                  .poll-item-vote-count(ng-show="poll_item.votes_count > 0")
                    {{poll_item.votes_count}}
          .poll-item-text
            %a.poll-item-details-btn(ng-click='pollItemDetails(poll_item)')
              %h2
                {{poll_item.title}}
            .poll-item-details(ng-show='poll_item.show_details')
              %p {{poll_item.description}}
              %ul(ng-repeat='user in poll_item.users')
                %li
                  {{user.name}}
          .poll-item-sharing
            %a.poll-item-btn
              %i.icon-share-alt
          .poll-item-comments
            %a.poll-item-btn
              %i.icon-comment-alt