- content_for :title, "Sous Vide Egg Calculator"
 
.activity-loading-spinner(ng-hide="true")
  %i.icon-page-load 
   
.egg-app#egg-top(ng-controller="EggTimerController" csskipnav)
  .egg-bg(ng-class="{'easter-egg' : easterEgg}")
  .egg-timer-container(ng-cloak)
    .egg-header
      %a.egg-hamburger(ng-click="toggleShowSettings($event)" ng-dblclick="easterEgg = ! easterEgg")
        .hamburger-bar
        .hamburger-bar
        .hamburger-bar
      .egg-title
        %h3 EGGS

    .egg-body
      .page-bg(ng-hide="inputs.state == 'size'")
        %img(src="assets/egg_timer_background.png")
      .page-switch(ng-switch="inputs.state" ng-animate="'fade'")
        .page(ng-switch-when="white")
          %h4.text-center What texture would you like your egg white?
          %csfrictionslider.egg-image-carousel(item-offset="inputs.perceptual_white_viscosity" item-width="300")
            %img(ng-src="{{whiteImage.image}}" ng-repeat="whiteImage in whiteImages" )
          .control-group.text-center
            .controls
              Runny
              %input(type="range" ng-model='inputs.perceptual_white_viscosity' min="0" max="13")
              Firm
          .egg-footer
            .btn.btn-primary(ng-click="goState('yolk')") 
              NEXT
              %i.icon-angle-right

        .page(ng-switch-when="yolk")
          %h4.text-center What texture would you like your egg yolk?
          %csfrictionslider.egg-image-carousel(item-offset="inputs.perceptual_yolk_viscosity - 1" item-width="300")
            %img(ng-src="{{yolkImage}}" ng-repeat="yolkImage in yolkImages" )
          %h6.text-center
            Like {{perceptualYolkDescriptor(inputs.perceptual_yolk_viscosity)}}
          .control-group.text-center
            .controls
              Runny
              %input(type="range" ng-model='inputs.perceptual_yolk_viscosity' min="1" max="7" step=".01")
              Firm
          .egg-footer
            .btn.btn-left.btn-primary(ng-click="goState('white')") 
              %i.icon-angle-left
            .btn.btn-right.btn-primary(ng-click="goState('results')") 
              %i.icon-angle-right

        .page(ng-switch-when="results")
          .section
            %h2.text-center {{water_temp}} &deg;C
          .section
            .labeled-time
              %span Ice and reheat
              %h3(ng-show="loading")
                %i.icon-spinner.icon-spin
              %h3(ng-show="! loading") {{formatTime(output.items[4], needsSeconds())}}
            .labeled-time
              %span Serve immediately
              %h3(ng-show="! loading") {{formatTime(output.items[1], needsSeconds())}}
              %h3(ng-show="loading")
                %i.icon-spinner.icon-spin
          .section-tiny.text-center
            Add data for more accurate time:
            .btn.btn-circle.large(ng-click="goState('size')") 
              %h5 Egg Size
            .btn.btn-circle.large(ng-click="goState('startTemp')") 
              %h5 Start Temp
            .btn.btn-circle.large(ng-click="goState('bathType')") 
              %h5 Bath Type
          .egg-footer
            .btn.btn-secondary(ng-click="goState('white')") 
              START OVER
            .btn.btn-primary(ng-click="goState('share')") 
              SHARE

        .page(ng-switch-when="share")
          .section
            %h4 Share the egg calculator on your social networks:
          .section
            = render 'layouts/social_buttons', media_object: nil
          .egg-footer
            .btn.btn-primary(ng-click="goState('white')") 
              NEW EGG

        .page(ng-switch-when="size")
          %h4.text-center What (US) size is your egg?
          .section.text-center
            %ul.nav.nav-tabs.underline.landing-tab-menu
              %li(ng-click="inputs.circumference = 110" ng-class="{'active': inputs.circumference == 110}") 
                %a Medium
              %li(ng-click="inputs.circumference = 135" ng-class="{'active': inputs.circumference == 135}") 
                %a Large
              %li(ng-click="inputs.circumference = 148" ng-class="{'active': inputs.circumference == 148}") 
                %a X-Large
              %li(ng-click="inputs.circumference = 157" ng-class="{'active': inputs.circumference == 157}") 
                %a Jumbo
          %h5.text-center.measure-text
            &hellip; or measure with a string around widest part:
          .section-tiny.text-center
            .egg-circumference-image
              %img(src="https://d3awvtnmmsvyot.cloudfront.net/api/file/yDpraXOTqaSsZAcEuvpw/convert?fit=max&w=640&cache=true")
          .section-tiny.text-center.egg-circumference
            %input.tiny-input(type="number" ng-model="inputs.circumference" size="3") 
            mm
          .egg-footer
            .btn.btn-secondary(ng-click="goState('startTemp')") 
              ADD START TEMP
            .btn.btn-primary(ng-click="goState('results')") 
              DONE

        .page(ng-switch-when="startTemp")
          %h4.text-center What temperature is your egg?
          .section.text-center
            %ul.nav.nav-tabs.underline.landing-tab-menu.text-center
              %li(ng-click="inputs.start_temp = 5" ng-class="{'active': inputs.start_temp == 5}") 
                %a Refrigerated
              %li(ng-click="inputs.start_temp = 22" ng-class="{'active': inputs.start_temp == 22}") 
                %a Room Temperature

          .section.text-center
            OR 
          .section.text-center
            %input.tiny-input(type="number" ng-model="inputs.start_temp") &deg;C
          .egg-footer
            .btn.btn-secondary(ng-click="goState('bathType')") 
              ADD BATH TYPE
            .btn.btn-primary(ng-click="goState('results')") 
              DONE

        .page(ng-switch-when="bathType")
          %h4.text-center What type of water bath are you using?

          .section.text-center
            %ul.nav.nav-tabs.underline.landing-tab-menu
              %li(ng-click="inputs.surface_heat_transfer_coeff  = 135" ng-class="{'active': inputs.surface_heat_transfer_coeff == 135}")
                %a Stirred
              %li(ng-click="inputs.surface_heat_transfer_coeff  = 165" ng-class="{'active': inputs.surface_heat_transfer_coeff == 165}")
                %a Unstirred

          .egg-footer
            .btn.btn-primary(ng-click="goState('results')") 
              DONE


            
    .debugging(ng-show="debugging")                
      %h2 DEBUGGING
      .section
      .section
        %h3 
          Computed Times
          %i.icon-spin.icon-spinner(ng-show="loading")
        .section-tiny
          %h5 Immediate Service: 
          Min {{formatTime(output.items[0])}}, 
          %b Suggested {{formatTime(output.items[1])}}
          , Max {{formatTime(output.items[2])}}
        .section-tiny
          %h5 Ice Water Chilled: 
          Min {{formatTime(output.items[3])}}, 
          %b Suggested {{formatTime(output.items[4])}}
          , Max {{formatTime(output.items[5])}}
      .section
        %h3 Inputs
        .control-group
          %label Perceptual desired white viscosity: {{inputs.perceptual_white_viscosity}}
          %label Water Temp {{inputs.water_temp}} &deg;c
          %label Perceptual desired viscosity {{oneDecimal(inputs.perceptual_yolk_viscosity)}}
          %label Desired Viscosity {{oneDecimal(inputs.desired_viscosity)}} 
          %label Egg Diameter {{inputs.diameter}} mm
          %label Start Temp {{inputs.start_temp}}
          %label Heat Transfer Coefficient {{inputs.surface_heat_transfer_coeff}}


  

